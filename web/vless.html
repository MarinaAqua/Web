<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Buat Akun VLESS</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- Header -->
  <div class="bg-purple-600 text-white text-center py-4 text-xl font-semibold">
    ✅ VLESS Created
  </div>

  <!-- Form Input -->
  <div class="max-w-md mx-auto mt-6 p-4 bg-white rounded shadow space-y-4">
    <input id="ipPort" type="text" placeholder="Masukkan IP:Port (contoh: 104.26.14.14:443)" class="w-full border p-2 rounded" />
    <input id="domain" type="text" placeholder="Domain (contoh: bug.cloudflare.com)" class="w-full border p-2 rounded" />
    <input id="bug" type="text" placeholder="Bug Wildcard (contoh: cdn.cloudflare.net)" class="w-full border p-2 rounded" />
    <button onclick="generateVLESS()" class="w-full bg-purple-600 text-white p-2 rounded hover:bg-purple-700">
      🔧 Buat Akun
    </button>
  </div>

  <!-- Hasil -->
  <div id="result" class="max-w-md mx-auto mt-4 p-4 bg-white rounded shadow hidden space-y-3 text-sm">
    <div>🌐 Remark: <span id="remarks" class="font-semibold"></span></div>
    <div>🟢 Ping: <span> id="ping" <h1 style="color:green; font-size:80%;"></h1></span></div>
    <div>📡 Domain: <span id="res-domain"></span></div>
    <div>🐞 SNI/Bug: <span id="res-bug"></span></div>
    <div>🆔 UUID: <span id="uuid">aaaaaaa1-bbbb-4ccc-addd-eeeeeeeeeee1</span></div>
    <div>🚪 Port: <span id="res-port"></span></div>
    <div>🔐 TLS: TLS</div>
    <div>📁 Path: <span id="path"></span></div>
    <div>🔗 Link:
      <textarea readonly id="vless-link" class="w-full mt-1 p-2 bg-gray-100 rounded text-xs"></textarea>
    </div>
    <div class="text-center">
      <img id="qrcode" src="" alt="QR Code" class="mx-auto my-2 rounded shadow" />
      <button onclick="copyConfig()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">
        📋 Salin Konfigurasi
      </button>
    </div>
  </div>

  <!-- Script -->
  <script>
    async function generateVLESS() {
      const ipPort = document.getElementById('ipPort').value.trim();
      const domain = document.getElementById('domain').value.trim();
      const bug = document.getElementById('bug').value.trim();
      const resultBox = document.getElementById('result');

      if (!ipPort || !domain || !bug || !ipPort.includes(':')) {
        alert('Isi semua field dengan benar.');
        return;
      }

      const [ip, port] = ipPort.split(':');

      const uuid = 'aaaaaaa1-bbbb-4ccc-addd-eeeeeeeeeee1';
      const path = `/Club-Gratis/${ip}-${port}`;
      const url = `https://api-checker.aquamarinelavinia.workers.dev/?ip=${ip}:${port}`;

      try {
        const res = await fetch(url);
        const data = await res.json();

        if (!data.message) {
          alert('Proxy tidak aktif!');
          return;
        }

        const remarks = `${data.country} ${data.flag} [${data.isp}]`;
        const ping = `${data.delay}`;
        const link = `vless://${uuid}@${bug}:443?type=ws&encryption=none&security=tls&host=${bug}.${domain}&path=${path}#${encodeURIComponent(remarks)}`;

        // Tampilkan hasil
        document.getElementById('remarks').textContent = remarks;
        document.getElementById('ping').textContent = ping;
        document.getElementById('res-domain').textContent = domain;
        document.getElementById('res-bug').textContent = bug;
        document.getElementById('res-port').textContent = port;
        document.getElementById('path').textContent = path;
        document.getElementById('vless-link').value = link;
        document.getElementById('qrcode').src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(link)}`;
        resultBox.classList.remove('hidden');

      } catch (err) {
        alert('Gagal mengambil data proxy.');
        console.error(err);
      }
    }

    function copyConfig() {
      const link = document.getElementById('vless-link');
      link.select();
      document.execCommand('copy');
      alert('Konfigurasi berhasil disalin!');
    }
  </script>
</body>
</html>
